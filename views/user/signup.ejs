<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/jpeg" href="/images/Prime..jpg">
  <title>Sign Up - Prime</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #fafafa;
    }
    .auth-divider {
      display: flex;
      align-items: center;
      color: #9ca3af;
      font-size: 0.75rem;
    }
    .auth-divider::before,
    .auth-divider::after {
      content: "";
      flex: 1;
      border-bottom: 1px solid #e5e7eb;
    }
    .auth-divider::before {
      margin-right: 0.5rem;
    }
    .auth-divider::after {
      margin-left: 0.5rem;
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 bg-gray-50">
  <div class="w-full max-w-xs bg-white rounded-lg shadow-sm p-6">
    <!-- Logo -->
    <div class="mb-4 text-center">
      <h1 class="text-xl font-medium">Prime</h1>
    </div>

    <!-- Error Message -->
    <% if (message) { %>
      <div class="mb-3 p-2 text-xs text-red-600 bg-red-50 rounded">
        <%= message %>
      </div>
    <% } %>

    <!-- Signup Form -->
    <form id="signupForm" class="space-y-3" method="post" action="/signupaction" novalidate>
      <div>
        <label for="name" class="block text-xs font-medium mb-1">Full name</label>
        <input 
          type="text" 
          id="name" 
          placeholder="John Doe" 
          name="name" 
          class="w-full px-3 py-2 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-gray-400" 
          required 
          minlength="2"
          maxlength="50"
          pattern="^[a-zA-Z]+(([',. -][a-zA-Z ])?[a-zA-Z]*)*$"
        >
        <div id="nameError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid name (2-50 characters)</div>
      </div>

      <div>
        <label for="email" class="block text-xs font-medium mb-1">Email</label>
        <input 
          type="email" 
          id="email" 
          placeholder="you@example.com" 
          name="email" 
          class="w-full px-3 py-2 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-gray-400" 
          required
        >
        <div id="emailError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid email address</div>
      </div>

      <div>
        <label for="password" class="block text-xs font-medium mb-1">Password</label>
        <input 
          type="password" 
          id="password" 
          placeholder="••••••••" 
          name="password" 
          class="w-full px-3 py-2 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-gray-400" 
          required 
          minlength="8"
          pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$"
        >
        <div id="passwordError" class="text-red-500 text-xs mt-1 hidden">
          Must be 8+ chars with uppercase, lowercase, number & special char
        </div>
      </div>

      <div>
        <label for="confirmPassword" class="block text-xs font-medium mb-1">Confirm password</label>
        <input 
          type="password" 
          name="cPassword"  
          id="confirmPassword" 
          placeholder="••••••••" 
          class="w-full px-3 py-2 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-gray-400" 
          required
        >
        <div id="confirmPasswordError" class="text-red-500 text-xs mt-1 hidden">Passwords do not match</div>
      </div>

      <div>
        <label for="referalCode" class="block text-xs font-medium mb-1">Referral code <span class="text-gray-400">(optional)</span></label>
        <input 
          type="text" 
          id="referalCode" 
          placeholder="Enter referral code" 
          name="referalCode" 
          class="w-full px-3 py-2 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-gray-400"
        >
        <div class="text-gray-400 text-xs mt-1">Get ₹70 credit with a referral code</div>
      </div>

      <button 
        type="submit" 
        class="w-full py-2 text-sm font-medium text-white bg-gray-900 rounded hover:bg-gray-800 focus:outline-none focus:ring-1 focus:ring-gray-600"
      >
        Create account
      </button>

      <div class="text-xs text-gray-500 text-center">
        By signing up, you agree to our 
        <a href="#" class="text-gray-700 underline">Terms</a> and 
        <a href="#" class="text-gray-700 underline">Privacy Policy</a>
      </div>

      <!-- Divider -->
      <div class="my-3 auth-divider">
        <span>or</span>
      </div>

      <!-- Social Signup -->
      <div class="space-y-2">
        <a 
          href="/auth/google/signup" 
          class="flex items-center justify-center gap-2 w-full py-2 text-xs border border-gray-200 rounded hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-gray-400"
        >
          <img src="https://www.google.com/favicon.ico" class="w-3 h-3" alt="Google">
          Continue with Google
        </a>
      </div>

      <div class="text-xs text-center text-gray-500">
        Already have an account? 
        <a href="/login" class="text-gray-700 underline">Log in</a>
      </div>
    </form>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('signupForm');
    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const confirmPasswordInput = document.getElementById('confirmPassword');
    
    const nameError = document.getElementById('nameError');
    const emailError = document.getElementById('emailError');
    const passwordError = document.getElementById('passwordError');
    const confirmPasswordError = document.getElementById('confirmPasswordError');

    nameInput.addEventListener('input', validateName);
    emailInput.addEventListener('input', validateEmail);
    passwordInput.addEventListener('input', validatePassword);
    confirmPasswordInput.addEventListener('input', validateConfirmPassword);

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const isNameValid = validateName();
      const isEmailValid = validateEmail();
      const isPasswordValid = validatePassword();
      const isConfirmPasswordValid = validateConfirmPassword();
      
      if (isNameValid && isEmailValid && isPasswordValid && isConfirmPasswordValid) {
        form.submit();
      }
    });

    function validateName() {
      const name = nameInput.value.trim();
      const isValid = name.length >= 2 && name.length <= 50 && /^[a-zA-Z]+(([',. -][a-zA-Z ])?[a-zA-Z]*)*$/.test(name);
      
      toggleError(nameInput, nameError, isValid);
      return isValid;
    }

    function validateEmail() {
      const email = emailInput.value.trim();
      const isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
      
      toggleError(emailInput, emailError, isValid);
      return isValid;
    }

    function validatePassword() {
      const password = passwordInput.value;
      const isValid = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(password);
      
      toggleError(passwordInput, passwordError, isValid);
      return isValid;
    }

    function validateConfirmPassword() {
      const password = passwordInput.value;
      const confirmPassword = confirmPasswordInput.value;
      const isValid = password === confirmPassword && password !== '';
      
      toggleError(confirmPasswordInput, confirmPasswordError, isValid);
      return isValid;
    }

    function toggleError(input, errorElement, isValid) {
      if (!isValid) {
        errorElement.classList.remove('hidden');
        input.classList.add('border-red-500');
        input.classList.remove('border-green-500');
      } else {
        errorElement.classList.add('hidden');
        input.classList.remove('border-red-500');
        input.classList.add('border-green-500');
      }
    }
  });
  </script>
</body>
</html>